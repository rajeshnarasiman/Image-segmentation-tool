<!DOCTYPE html>
<html ng-app="labelling_app">
<head lang="en">
	<meta charset="UTF-8">
	<title>{% block title %}{% endblock title %}</title>
	<link href="/static/css/bootstrap.min.css" rel="stylesheet" />
	<link href="/static/djangular/css/styles.css" rel="stylesheet" />
	<link href="/static/djangular/css/bootstrap3.css" rel="stylesheet" />
	<link type="text/css" rel="stylesheet" href="/static/cctvsite.css"/>
	<link type="text/css" rel="stylesheet" href="/static/labelling.css"/>
	<link type="text/css" rel="stylesheet" href="/static/jquery/jquery-ui.min.css"/>
	<link type="text/css" rel="stylesheet" href="/static/jquery/jquery-ui.structure.min.css"/>
	<link type="text/css" rel="stylesheet" href="/static/jquery/jquery-ui.theme.min.css"/>

	{% block pagecss %}{% endblock pagecss %}

	<script src="/static/angular.min.js" type="text/javascript"></script>
	<script src="/static/angular-route.min.js" type="text/javascript"></script>
	<script src="/static/angular-resource.min.js" type="text/javascript"></script>
	<script src="/static/angular-file-upload.min.js" type="text/javascript"></script>
	<script src="/static/json2.js"></script>
	<script src="/static/jquery/jquery-2.1.1.min.js"></script>
	<script src="/static/jquery/jquery-ui.min.js"></script>
	<script src="/static/js/bootstrap.min.js"></script>

    <script>
        var cvaasApp = angular.module('labelling_app', ['angularFileUpload']);

        cvaasApp.controller('FileUploadController', ['$scope', 'FileUploader', function($scope, FileUploader) {
            // Incorporate the CSRF token otherwise Django will reject the upload
            var formdata = [
                {csrfmiddlewaretoken: '{{ csrf_token }}'}
            ];

            var uploader = $scope.uploader = new FileUploader({
                formData: formdata
            });

            // FILTERS

{#            uploader.filters.push({#}
{#                name: 'customFilter',#}
{#                fn: function(item /*{File|FileLikeObject}*/, options) {#}
{#                    return this.queue.length < 10;#}
{#                }#}
{#            });#}

            // CALLBACKS

            uploader.onWhenAddingFileFailed = function(item /*{File|FileLikeObject}*/, filter, options) {
                console.info('onWhenAddingFileFailed', item, filter, options);
            };
            uploader.onAfterAddingFile = function(fileItem) {
                console.info('onAfterAddingFile', fileItem);
            };
            uploader.onAfterAddingAll = function(addedFileItems) {
                console.info('onAfterAddingAll', addedFileItems);
            };
            uploader.onBeforeUploadItem = function(item) {
                console.info('onBeforeUploadItem', item);
            };
            uploader.onProgressItem = function(fileItem, progress) {
                console.info('onProgressItem', fileItem, progress);
            };
            uploader.onProgressAll = function(progress) {
                console.info('onProgressAll', progress);
            };
            uploader.onSuccessItem = function(fileItem, response, status, headers) {
                console.info('onSuccessItem', fileItem, response, status, headers);
            };
            uploader.onErrorItem = function(fileItem, response, status, headers) {
                console.info('onErrorItem', fileItem, response, status, headers);
            };
            uploader.onCancelItem = function(fileItem, response, status, headers) {
                console.info('onCancelItem', fileItem, response, status, headers);
            };
            uploader.onCompleteItem = function(fileItem, response, status, headers) {
                console.info('onCompleteItem', fileItem, response, status, headers);
            };
            uploader.onCompleteAll = function() {
                console.info('onCompleteAll');

                if (uploader.reloadOnComplete) {
                    location.reload();
                }
            };

            $scope.init = function(url, reloadOnComplete) {
                uploader.url = url;
                uploader.formData = formdata;
                uploader.reloadOnComplete = reloadOnComplete;
            };
        }]);
    </script>

    {% block pagejs %}{% endblock pagejs %}
</head>
<body>


{% block navbar %}
{% endblock navbar %}


{% block page_titlebar %}
{% endblock page_titlebar %}


<div class="page_content">
	{% block pagecontent %}
	{% endblock pagecontent %}
</div>

{% block pageendjs %}
{% endblock pageendjs %}

</body>
</html>